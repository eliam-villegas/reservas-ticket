
# ğŸ§ª Simulaciones para Escenario 1 â€“ Consistencia + Tolerancia a Particiones

Este documento describe dos simulaciones realizadas para validar que el sistema desarrollado cumple con el **Escenario 1 del Teorema CAP**, priorizando **consistencia** y **tolerancia a particiones**, sacrificando **disponibilidad** cuando sea necesario.

---

## âœ… SimulaciÃ³n 1: Apagar nodos para simular particiÃ³n de red

### ğŸ¯ Objetivo:
Demostrar que si se pierde conexiÃ³n con mÃ¡s de un nodo, el sistema **bloquea la reserva de entradas** para mantener la consistencia.

### ğŸ”§ Pasos:

1. Levantar el sistema:
   ```bash
   docker-compose up -d
   ```

2. Ingresar al sistema desde el navegador:
   ```
   http://localhost:81/reservas/reservar.php
   ```

3. Verificar que se pueden realizar reservas normalmente.

4. Simular una particiÃ³n de red deteniendo dos nodos:
   ```bash
   docker stop mysql_node2
   docker stop mysql_node3
   ```

5. Recargar la pÃ¡gina o intentar una nueva reserva.

6. âœ… Resultado esperado:
    - El sistema mostrarÃ¡ el mensaje:
      ```
      âŒ Sistema no disponible por particiÃ³n de red.
      ```
    - La operaciÃ³n es cancelada automÃ¡ticamente, preservando la **consistencia global**.

7. (Opcional) Capturar evidencia:
    - Captura de pantalla del error mostrado.
    - Comando `docker ps` mostrando los nodos apagados.

8. Reiniciar los nodos al finalizar la prueba:
   ```bash
   docker start mysql_node2 mysql_node3
   ```

---

## âœ… SimulaciÃ³n 2: Reservas simultÃ¡neas desde dos usuarios

### ğŸ¯ Objetivo:
Demostrar que si dos usuarios intentan reservar **el mismo asiento en la misma fecha al mismo tiempo**, **solo uno logra la reserva**, manteniendo consistencia y evitando sobreventa.

### ğŸ”§ Pasos:

1. Asegurarse de que el sistema estÃ¡ activo:
   ```bash
   docker-compose up -d
   ```

2. Obtener la IP local del servidor:
   En Windows, ejecutar:
   ```bash
   ipconfig
   ```
   Anotar la direcciÃ³n IPv4 (ejemplo: `192.168.1.100`).

3. Permitir el acceso a travÃ©s del firewall:
    - Abrir Firewall de Windows Defender.
    - Crear una nueva **Regla de entrada**:
        - Tipo: Puerto
        - Puerto: TCP 81
        - Permitir conexiÃ³n en redes privadas

4. Compartir la URL con el otro usuario:
   ```
   http://192.168.1.100:81/reservas/reservar.php
   ```

5. Desde dos dispositivos diferentes:
    - Ingresar a la misma URL.
    - Elegir **la misma fecha y asiento**.
    - Escribir distintos nombres de cliente.
    - Presionar **â€œReservarâ€ al mismo tiempo**.

6. âœ… Resultado esperado:
    - Uno de los usuarios recibe confirmaciÃ³n de la reserva.
    - El otro ve el mensaje:
      ```
      âš ï¸ El asiento ya estÃ¡ reservado en al menos un nodo.
      ```

7. (Opcional) Capturar evidencia:
    - Ambas pantallas (Ã©xito y rechazo).
    - CÃ³digo de reserva registrado en base de datos (si aplica).

---

## ğŸ“Œ ConclusiÃ³n

Ambas simulaciones validan que el sistema:
- Garantiza **consistencia fuerte**.
- Detecta y bloquea operaciones ante fallos de red (simulaciÃ³n 1).
- Gestiona correctamente condiciones de carrera en concurrencia (simulaciÃ³n 2).

Esto confirma el cumplimiento del **Escenario 1 del Teorema CAP: Consistencia + Tolerancia a particiones**.
